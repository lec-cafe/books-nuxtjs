# Firestore への表示

認証の機能が利用できるようになったら、最後に Firestore でメッセージデータを保存しましょう。

## 一覧画面への表示

`store/chat.js` を以下のような形で実装します。

```vue
export const state = () => {
  return {
    messages: []
  }
}

export const mutations = {
  ADD_MESSAGE(state,message){
    state.messages.unshift(message)
  },
  LOAD_MESSAGE(state,messages){
    state.messages = messages
  }

}

export const actions = {
  async getMessages({commit}){
    const db = this.$fb.firestore()
    const result = await db.collection("messages").get()
    commit("LOAD_MESSAGE",result.docs.map((d)=>d.data()))

  },
}
```

`pages/index.vue` では、以下のように mounted で実装された action を呼び出す処理を追加しましょう。

```vue
<template>
  <div>
    ...
  </div>
</template>

<script>
  export default {
    // ...
    async mounted() {
     await this.$store.dispatch("chat/getMessages")
    },
  }
</script>
```

## Check & Try

- 認証ユーザの名前でメッセージを投稿できることを確認してみましょう。
- 投稿されたデータが Firestore の管理画面上に表示されていることを確認してみましょう。
- onAuthStateChanged の user 引数を確認して、その他の認証情報を確認してみましょう。












